---

# 📘 투자 관리 서비스 API 명세서 (샘플 JSON, Enum, 클래스 통합)

---

## 공통 베이스 클래스

```python
from pydantic import BaseModel
from enum import IntEnum, Enum
from typing import List, Optional

class BaseRequest(BaseModel):
    accessToken: str = ""
    sequence: int = 0

class BaseResponse(BaseModel):
    errorCode: int = 0
    sequence: int = 0
```

---

# 1. 인증 관리

---

## 1.1 Enum

```python
class PlatformType(IntEnum):
    NORMAL = 1
    SOCIAL = 2
```

---

## 1.2 회원가입

### 클래스

```python
class AccountSignupRequest(BaseRequest):
    platform_type: int = PlatformType.NORMAL
    account_id: str
    password: str
    nickname: str
    email: str

class AccountSignupResponse(BaseResponse):
    account_db_key: int = 0
    message: str = ""
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "",
  "sequence": 1,
  "platform_type": 1,
  "account_id": "investor01",
  "password": "S3cur3P@ss",
  "nickname": "투자왕",
  "email": "investor01@example.com"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 1,
  "account_db_key": 12345,
  "message": "회원가입 성공"
}
```

---

## 1.3 로그인 (1단계)

### 클래스

```python
class AccountLoginRequest(BaseRequest):
    platform_type: int = PlatformType.NORMAL
    account_id: str
    password: str

class AccountLoginResponse(BaseResponse):
    accessToken: str = ""
    account_db_key: int = 0
    nickname: str = ""
    account_level: int = 1
    shard_id: int = 0
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "",
  "sequence": 2,
  "platform_type": 1,
  "account_id": "investor01",
  "password": "S3cur3P@ss"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 2,
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "account_db_key": 12345,
  "nickname": "투자왕",
  "account_level": 1,
  "shard_id": 2
}
```

---

## 1.4 로그인 (2단계 OTP)

### 클래스

```python
class OtpVerifyRequest(BaseRequest):
    otp_code: str

class OtpVerifyResponse(BaseResponse):
    message: str = ""
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 3,
  "otp_code": "123456"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 3,
  "message": "OTP 인증 성공"
}
```

---

## 1.5 OTP 등록

### 클래스

```python
class OtpRegisterRequest(BaseRequest):
    otp_secret: str
    otp_code: str

class OtpRegisterResponse(BaseResponse):
    message: str = ""
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 4,
  "otp_secret": "JBSWY3DPEHPK3PXP",
  "otp_code": "123456"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 4,
  "message": "OTP 등록 성공"
}
```

---

# 2. 대시보드

---

## 2.1 클래스

```python
class DashboardInfoRequest(BaseRequest):
    pass

class DashboardInfoResponse(BaseResponse):
    cash_balance: float = 0.0
    holdings: List[dict] = []
    portfolio_value: float = 0.0
    performance_chart: List[dict] = []
    allocation_chart: List[dict] = []
    alerts: List[dict] = []
    watchlist: List[dict] = []
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 5
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 5,
  "cash_balance": 1500000.0,
  "holdings": [
    {"ticker": "005930", "quantity": 10, "current_price": 75000}
  ],
  "portfolio_value": 2250000.0,
  "performance_chart": [],
  "allocation_chart": [],
  "alerts": [],
  "watchlist": []
}
```

---

# 3. 포트폴리오

---

## 3.1 Enum

```python
class PortfolioAction(str, Enum):
    ADD = "add"
    REMOVE = "remove"
```

---

## 3.2 포트폴리오 조회

### 클래스

```python
class PortfolioInfoRequest(BaseRequest):
    pass

class PortfolioInfoResponse(BaseResponse):
    portfolio: List[dict] = []
    total_return: float = 0.0
    past_returns: List[dict] = []
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 6
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 6,
  "portfolio": [
    {"ticker": "005930", "quantity": 10, "avg_price": 70000}
  ],
  "total_return": 0.15,
  "past_returns": []
}
```

---

## 3.3 포트폴리오 수정

### 클래스

```python
class PortfolioModifyRequest(BaseRequest):
    action: PortfolioAction
    ticker: str
    quantity: int

class PortfolioModifyResponse(BaseResponse):
    message: str = ""
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 7,
  "action": "add",
  "ticker": "005930",
  "quantity": 5
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 7,
  "message": "종목 추가 완료"
}
```

---

# 4. AI 챗봇

---

## 4.1 클래스

```python
class ChatMessageRequest(BaseRequest):
    chat_id: str
    message: str

class ChatMessageResponse(BaseResponse):
    response_message: str
    suggestions: List[str] = []
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 8,
  "chat_id": "chat-001",
  "message": "삼성전자 전망 어때?"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 8,
  "response_message": "삼성전자는 최근 호재로 상승세입니다.",
  "suggestions": ["LG전자도 알려줘", "IT섹터 전망은?"]
}
```

---

## 4.2 요약

### 클래스

```python
class ChatSummaryRequest(BaseRequest):
    chat_id: str

class ChatSummaryResponse(BaseResponse):
    summary_text: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 9,
  "chat_id": "chat-001"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 9,
  "summary_text": "삼성전자의 단기적 상승 요인과 리스크를 요약하였습니다."
}
```

---

## 4.3 새 채팅 생성

### 클래스

```python
class ChatCreateRequest(BaseRequest):
    persona: str

class ChatCreateResponse(BaseResponse):
    chat_id: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 10,
  "persona": "워렌 버핏"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 10,
  "chat_id": "chat-002"
}
```

---

# 5. 자동매매

---

## 5.1 Enum

```python
class AutoTradeAction(str, Enum):
    START = "start"
    STOP = "stop"
```

---

## 5.2 자동매매 제어

### 클래스

```python
class AutoTradeControlRequest(BaseRequest):
    action: AutoTradeAction
    strategy_id: str

class AutoTradeControlResponse(BaseResponse):
    message: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 11,
  "action": "start",
  "strategy_id": "strategy-abc"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 11,
  "message": "자동매매 시작"
}
```

---

## 5.3 자동매매 상태 조회

### 클래스

```python
class AutoTradeStatusRequest(BaseRequest):
    pass

class AutoTradeStatusResponse(BaseResponse):
    profit_rate: float = 0.0
    win_rate: float = 0.0
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 12
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 12,
  "profit_rate": 0.07,
  "win_rate": 0.53
}
```

---

# 6. 설정

---

## 6.1 프로필 설정

### 클래스

```python
class ProfileSettingUpdateRequest(BaseRequest):
    investment_experience: str
    risk_preference: str
    investment_goal: str
    monthly_budget: float

class ProfileSettingUpdateResponse(BaseResponse):
    message: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 13,
  "investment_experience": "중상",
  "risk_preference": "공격형",
  "investment_goal": "은퇴자금",
  "monthly_budget": 300000
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 13,
  "message": "프로필 설정 완료"
}
```

---

## 6.2 알림 설정

### 클래스

```python
class NotificationSettingUpdateRequest(BaseRequest):
    price_alert: bool
    news_alert: bool
    portfolio_alert: bool
    trade_alert: bool

class NotificationSettingUpdateResponse(BaseResponse):
    message: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 14,
  "price_alert": true,
  "news_alert": false,
  "portfolio_alert": true,
  "trade_alert": true
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 14,
  "message": "알림 설정 저장됨"
}
```

---

## 6.3 보안 설정

### 클래스

```python
class SecuritySettingUpdateRequest(BaseRequest):
    otp_enabled: bool
    session_timeout_minutes: int

class SecuritySettingUpdateResponse(BaseResponse):
    message: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 15,
  "otp_enabled": true,
  "session_timeout_minutes": 30
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 15,
  "message": "보안 설정 저장됨"
}
```

---

## 6.4 화면 설정

### Enum

```python
class Language(str, Enum):
    KO = "ko"
    EN = "en"

class Currency(str, Enum):
    KRW = "KRW"
    USD = "USD"

class ChartStyle(str, Enum):
    CANDLE = "candlestick"
    BAR = "bar"
```

### 클래스

```python
class DisplaySettingUpdateRequest(BaseRequest):
    language: Language
    currency: Currency
    chart_style: ChartStyle

class DisplaySettingUpdateResponse(BaseResponse):
    message: str
```

### 샘플 JSON

**Request**

```json
{
  "accessToken": "eyJhbGciOiJIUzI1NiIs...",
  "sequence": 16,
  "language": "ko",
  "currency": "KRW",
  "chart_style": "candlestick"
}
```

**Response**

```json
{
  "errorCode": 0,
  "sequence": 16,
  "message": "화면 설정 저장됨"
}
```

---

# 7. 공통 응답코드 표

| errorCode  | 설명          |
| ---------- | ----------- |
| 0          | 성공          |
| 1000       | 서버 오류       |
| 1001\~1099 | 로그인 관련 오류   |
| 2000\~2099 | 계좌/포트폴리오 오류 |
| 3000\~3099 | 회원가입 오류     |
| 4000\~4099 | 챗봇 처리 오류    |
| 5000\~5099 | 자동매매 처리 오류  |

---
