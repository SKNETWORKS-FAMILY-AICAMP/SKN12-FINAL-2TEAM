# AI Trading Platform â€” LLM Service

> **ê°œìš”**: SKN12-FINAL-2TEAMì˜ AI íŠ¸ë ˆì´ë”© í”Œë«í¼ ë°±ì—”ë“œ LLM ì„œë¹„ìŠ¤ì…ë‹ˆë‹¤. OpenAI GPT ëª¨ë¸ì„ ê¸°ë°˜ìœ¼ë¡œ ê¸ˆìœµ ë¶„ì„ ë„êµ¬ë“¤ê³¼ ì—°ë™í•˜ì—¬ ì§€ëŠ¥í˜• íˆ¬ì ìƒë‹´ê³¼ ì‹œì¥ ë¶„ì„ì„ ì œê³µí•˜ëŠ” LangChain + LangGraph ê¸°ë°˜ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

---

## ğŸ—ï¸ í”„ë¡œì íŠ¸ êµ¬ì¡°

### ë””ë ‰í† ë¦¬ êµ¬ì¡°
```
llm/
â”œâ”€â”€ __init__.py                    # íŒ¨í‚¤ì§€ ì´ˆê¸°í™”
â”œâ”€â”€ AIChat_service.py              # ë©”ì¸ AI ì±„íŒ… ì„œë¹„ìŠ¤
â”œâ”€â”€ llm_config.py                  # LLM ì„¤ì • ë° êµ¬ì„±
â””â”€â”€ AIChat/                        # AI ì±„íŒ… í•µì‹¬ ëª¨ë“ˆ
    â”œâ”€â”€ __init__.py                # AIChat íŒ¨í‚¤ì§€ ì´ˆê¸°í™”
    â”œâ”€â”€ Router.py                  # LangGraph ê¸°ë°˜ ë¼ìš°í„°
    â”œâ”€â”€ BaseFinanceTool.py         # ê¸ˆìœµ ë„êµ¬ ê¸°ë³¸ í´ë˜ìŠ¤
    â”œâ”€â”€ SessionAwareTool.py        # ì„¸ì…˜ ì¸ì‹ ë„êµ¬
    â”œâ”€â”€ requirements.txt           # Python ì˜ì¡´ì„±
    â”œâ”€â”€ BasicTools/                # ê¸°ë³¸ ê¸ˆìœµ ë¶„ì„ ë„êµ¬
    â”‚   â”œâ”€â”€ FinancialStatementTool.py    # ì¬ë¬´ì œí‘œ ë¶„ì„
    â”‚   â”œâ”€â”€ MacroEconomicTool.py         # ê±°ì‹œê²½ì œ ë¶„ì„
    â”‚   â”œâ”€â”€ SectorAnalysisTool.py       # ì„¹í„° ë¶„ì„
    â”‚   â”œâ”€â”€ TechnicalAnalysisTool.py    # ê¸°ìˆ ì  ë¶„ì„
    â”‚   â”œâ”€â”€ MarketDataTool.py           # ì‹œì¥ ë°ì´í„°
    â”‚   â”œâ”€â”€ NewsTool.py                 # ë‰´ìŠ¤ ë¶„ì„
    â”‚   â””â”€â”€ IndustryAnalysisTool.py    # ì‚°ì—… ë¶„ì„
    â”œâ”€â”€ tool/                       # ê³ ê¸‰ ë¶„ì„ ë„êµ¬
    â”‚   â”œâ”€â”€ MarketRegimeDetectorTool.py # ì‹œì¥ ì²´ì œ ê°ì§€
    â”‚   â””â”€â”€ KalmanRegimeFilterTool.py   # ì¹¼ë§Œ í•„í„° ê¸°ë°˜ ì²´ì œ ë¶„ì„
    â”œâ”€â”€ renderer/                   # ì‘ë‹µ ë Œë”ë§
    â””â”€â”€ manager/                    # ë„êµ¬ ê´€ë¦¬
```

---

## ğŸ”§ í•µì‹¬ ê¸°ëŠ¥

### 1. **AI ì±„íŒ… ì„œë¹„ìŠ¤ (AIChatService)**
- **LLM í†µí•©**: OpenAI GPT ëª¨ë¸ê³¼ì˜ ì—°ë™ ë° ìŠ¤íŠ¸ë¦¬ë° ì§€ì›
- **ì„¸ì…˜ ê´€ë¦¬**: Redis ê¸°ë°˜ ëŒ€í™” íˆìŠ¤í† ë¦¬ ë° ë©”ëª¨ë¦¬ ê´€ë¦¬
- **ë©€í‹° í”„ë¡œí† ì½œ**: REST API ë° WebSocket ìŠ¤íŠ¸ë¦¬ë° ì§€ì›
- **ìºì‹œ ì—°ë™**: CacheServiceì™€ì˜ í†µí•©ìœ¼ë¡œ ì„±ëŠ¥ ìµœì í™”

### 2. **ê¸ˆìœµ ë¶„ì„ ë¼ìš°í„° (AIChatRouter)**
- **LangGraph íŒŒì´í”„ë¼ì¸**: ë³µì¡í•œ ê¸ˆìœµ ë¶„ì„ ì›Œí¬í”Œë¡œìš° ê´€ë¦¬
- **ë„êµ¬ ì²´ì¸**: ë‹¤ì–‘í•œ ê¸ˆìœµ ë¶„ì„ ë„êµ¬ë“¤ì˜ ìˆœì°¨ì  ì‹¤í–‰
- **ìƒíƒœ ê´€ë¦¬**: ë¶„ì„ ê³¼ì •ì˜ ìƒíƒœ ì¶”ì  ë° ê´€ë¦¬
- **ì—ëŸ¬ ì²˜ë¦¬**: ë„êµ¬ ì‹¤í–‰ ì‹¤íŒ¨ ì‹œ ëŒ€ì²´ ë¡œì§ ë° ë³µêµ¬

### 3. **ê¸°ë³¸ ê¸ˆìœµ ë„êµ¬ (BasicTools)**
- **ì¬ë¬´ì œí‘œ ë¶„ì„**: ê¸°ì—… ì¬ë¬´ ìƒíƒœ ë° ì„±ê³¼ ë¶„ì„
- **ê±°ì‹œê²½ì œ ë¶„ì„**: ê²½ì œ ì§€í‘œ ë° ì •ì±… ì˜í–¥ ë¶„ì„
- **ì„¹í„° ë¶„ì„**: ì‚°ì—…ë³„ ì„±ê³¼ ë° íŠ¸ë Œë“œ ë¶„ì„
- **ê¸°ìˆ ì  ë¶„ì„**: ì°¨íŠ¸ íŒ¨í„´ ë° ê¸°ìˆ ì  ì§€í‘œ ë¶„ì„
- **ì‹œì¥ ë°ì´í„°**: ì‹¤ì‹œê°„ ì‹œì¥ ì •ë³´ ë° ê°€ê²© ë°ì´í„°
- **ë‰´ìŠ¤ ë¶„ì„**: ê¸ˆìœµ ë‰´ìŠ¤ ë° ì‹œì¥ ë™í–¥ ë¶„ì„
- **ì‚°ì—… ë¶„ì„**: íŠ¹ì • ì‚°ì—…ì˜ êµ¬ì¡° ë° ê²½ìŸë ¥ ë¶„ì„

### 4. **ê³ ê¸‰ ë¶„ì„ ë„êµ¬ (Advanced Tools)**
- **ì‹œì¥ ì²´ì œ ê°ì§€**: ì‹œì¥ ìƒí™©ì— ë”°ë¥¸ ì²´ì œ ë³€í™” ê°ì§€
- **ì¹¼ë§Œ í•„í„°**: ì‹œê³„ì—´ ë°ì´í„°ì˜ ë…¸ì´ì¦ˆë¥¼ ì œê±°í•˜ê³ , ë³€ë™ì„± ë’¤ì— ìˆ¨ê²¨ì§„ ì‹¤ì œ ì¶”ì„¸(Regime)ë¥¼ ì¶”ì •í•˜ì—¬ ì‹œì¥ì˜ êµ­ë©´(ìƒìŠ¹/í•˜ë½/íš¡ë³´)ì„ íŒë‹¨

---

## ğŸ“š ì‚¬ìš©ëœ ë¼ì´ë¸ŒëŸ¬ë¦¬

### **Core AI/ML Framework**
- **LangChain**: LLM ì• í”Œë¦¬ì¼€ì´ì…˜ ê°œë°œ í”„ë ˆì„ì›Œí¬
- **LangGraph**: ë³µì¡í•œ AI ì›Œí¬í”Œë¡œìš° ê´€ë¦¬
- **OpenAI**: GPT ëª¨ë¸ API ì—°ë™
- **Pydantic**: ë°ì´í„° ê²€ì¦ ë° ì„¤ì • ê´€ë¦¬

### **ê¸ˆìœµ ë°ì´í„° & ë¶„ì„**
- **Financial Modeling Prep (FMP)**: ì¬ë¬´ì œí‘œ ë° ì‹œì¥ ë°ì´í„°
- **NewsAPI**: ê¸ˆìœµ ë‰´ìŠ¤ ë° ì‹œì¥ ë™í–¥
- **FRED**: ì—°ë°©ì¤€ë¹„ì œë„ ê²½ì œ ë°ì´í„°
- **Pandas**: ë°ì´í„° ì²˜ë¦¬ ë° ë¶„ì„
- **NumPy**: ìˆ˜ì¹˜ ê³„ì‚° ë° ë°°ì—´ ì²˜ë¦¬

### **ë°±ì—”ë“œ & ì¸í”„ë¼**
- **FastAPI**: ë¹„ë™ê¸° ì›¹ API í”„ë ˆì„ì›Œí¬
- **Redis**: ëŒ€í™” íˆìŠ¤í† ë¦¬ ë° ìºì‹±
- **WebSocket**: ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° í†µì‹ 
- **asyncio**: ë¹„ë™ê¸° í”„ë¡œê·¸ë˜ë°

### **ê°œë°œ ë„êµ¬**
- **Python 3.8+**: ë©”ì¸ í”„ë¡œê·¸ë˜ë° ì–¸ì–´
- **Type Hints**: íƒ€ì… ì•ˆì „ì„± ë° ì½”ë“œ ê°€ë…ì„±
- **Logging**: êµ¬ì¡°í™”ëœ ë¡œê¹… ì‹œìŠ¤í…œ

---

## ğŸª í•µì‹¬ í´ë˜ìŠ¤ ë° ë©”ì„œë“œ

### **AIChatService - ë©”ì¸ ì„œë¹„ìŠ¤ í´ë˜ìŠ¤**

```python
class AIChatService:
    def __init__(self, llm_config: LlmConfig):
        # OpenAI LLM ì¸ìŠ¤í„´ìŠ¤ ì´ˆê¸°í™”
        self.llm = ChatOpenAI(model=model, temperature=temperature)
        self.llm_stream = ChatOpenAI(streaming=True)  # ìŠ¤íŠ¸ë¦¬ë°ìš©
        self._session_mem: dict[str, ConversationBufferMemory] = {}
    
    def mem(self, session_id: str) -> ConversationBufferMemory:
        """ì„¸ì…˜ë³„ ëŒ€í™” ë©”ëª¨ë¦¬ ê´€ë¦¬ (Redis ê¸°ë°˜)"""
        # Redisì— ëŒ€í™” íˆìŠ¤í† ë¦¬ ì €ì¥
        # key_prefix: finance_app:LOCAL:chat:{session_id}
    
    async def chat(self, message: str, session_id: str = "", client_session=None):
        """REST APIìš© ì±„íŒ… ì‘ë‹µ ìƒì„±"""
        # AIChatRouterë¥¼ í†µí•œ ë„êµ¬ ì²´ì¸ ì‹¤í–‰
        # ë¹„ë™ê¸° ì²˜ë¦¬ë¡œ ë„êµ¬ í˜¸ì¶œ ì•ˆì „ì„± ë³´ì¥
    
    async def stream(self, ws: WebSocket):
        """WebSocketìš© ìŠ¤íŠ¸ë¦¬ë° ì±„íŒ… ì‘ë‹µ ìƒì„±"""
        # ì‹¤ì‹œê°„ ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ
        # SSE í˜¸í™˜ ê°€ëŠ¥í•œ í˜•íƒœë¡œ ë°ì´í„° ì „ì†¡
```

**ë™ì‘ ë°©ì‹**:
- LLM ì„¤ì •ì„ í†µí•œ ëª¨ë¸ ì´ˆê¸°í™”
- Redis ê¸°ë°˜ ì„¸ì…˜ë³„ ëŒ€í™” ë©”ëª¨ë¦¬ ê´€ë¦¬
- AIChatRouterë¥¼ í†µí•œ ë„êµ¬ ì²´ì¸ ì‹¤í–‰
- REST API ë° WebSocket ìŠ¤íŠ¸ë¦¬ë° ì§€ì›

### **AIChatRouter - ê¸ˆìœµ ë¶„ì„ ë¼ìš°í„°**

```python
class AIChatRouter:
    def __init__(self, client_session=None):
        self.client_session = client_session
        self.ai_chat_service = ServiceContainer.get_ai_chat_service()
        
        # ê¸ˆìœµ ë¶„ì„ ë„êµ¬ë“¤ ì´ˆê¸°í™”
        self.tools = [
            FinancialStatementTool(),
            MacroEconomicTool(),
            SectorAnalysisTool(),
            TechnicalAnalysisTool(),
            MarketDataTool(),
            NewsTool(),
            IndustryAnalysisTool(),
            MarketRegimeDetector(),
            KalmanRegimeFilterTool()
        ]
    
    def run_question(self, question: str) -> str:
        """ì‚¬ìš©ì ì§ˆë¬¸ì„ ë„êµ¬ ì²´ì¸ìœ¼ë¡œ ì²˜ë¦¬"""
        # LangGraph íŒŒì´í”„ë¼ì¸ ì‹¤í–‰
        # ë„êµ¬ ì„ íƒ ë° ìˆœì°¨ì  ì‹¤í–‰
        # ìµœì¢… ì‘ë‹µ ìƒì„±
```

**ë™ì‘ ë°©ì‹**:
- LangGraph ê¸°ë°˜ ìƒíƒœ ë¨¸ì‹  êµ¬ì„±
- ì‚¬ìš©ì ì§ˆë¬¸ì— ë”°ë¥¸ ì ì ˆí•œ ë„êµ¬ ì„ íƒ
- ë„êµ¬ ì²´ì¸ì„ í†µí•œ ìˆœì°¨ì  ë¶„ì„ ì‹¤í–‰
- ê²°ê³¼ í†µí•© ë° ìµœì¢… ì‘ë‹µ ìƒì„±

---

## ğŸŒ API ì—°ë™ ë°©ì‹

### **LLM ì„¤ì • ë° í”„ë¡œë°”ì´ë” ê´€ë¦¬**

```python
# llm_config.py
class LlmConfig(BaseModel):
    default_provider: str                    # ê¸°ë³¸ LLM í”„ë¡œë°”ì´ë”
    concurrent_requests: int                 # ë™ì‹œ ìš”ì²­ ìˆ˜ ì œí•œ
    providers: Dict[str, ProviderConfig]    # í”„ë¡œë°”ì´ë”ë³„ ì„¤ì •
    API_Key: Dict[str, str]                 # API í‚¤ ê´€ë¦¬
    
    # ì±„íŒ… ê´€ë ¨ ì„¤ì •
    max_conversation_length: int = 20       # ìµœëŒ€ ëŒ€í™” ê¸¸ì´
    system_prompts: Dict[str, str] = {}     # ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
    
    # ë¶„ì„ ê´€ë ¨ ì„¤ì •
    analysis_timeout: int = 60              # ë¶„ì„ íƒ€ì„ì•„ì›ƒ
    max_concurrent_requests: int = 5        # ìµœëŒ€ ë™ì‹œ ìš”ì²­
```

### **ì™¸ë¶€ API ì—°ë™**

```python
# AIChat_service.py
class AIChatService:
    def __init__(self, llm_config: LlmConfig):
        # OpenAI API í‚¤ ì„¤ì •
        api_key = os.getenv("OPENAI_API_KEY") or llm_config.providers[llm_config.default_provider].api_key
        
        # LLM ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
        self.llm = ChatOpenAI(
            model=llm_config.providers[llm_config.default_provider].model,
            temperature=llm_config.providers[llm_config.default_provider].temperature,
            openai_api_key=api_key
        )
```

### **Redis ìºì‹œ ì—°ë™**

```python
# AIChat_service.py
def mem(self, session_id: str) -> ConversationBufferMemory:
    """ì„¸ì…˜ë³„ ëŒ€í™” ë©”ëª¨ë¦¬ ê´€ë¦¬ (Redis ê¸°ë°˜)"""
    if session_id not in self._session_mem:
        cache_client = self.cache_service.get_client()
        redis_url = f"redis://{cache_client._host}:{cache_client._port}/{cache_client._db}"
        
        # RedisChatMessageHistory ìƒì„±
        history = RedisChatMessageHistory(
            session_id=session_id,
            url=redis_url,
            key_prefix=self.KEY_PREFIX  # finance_app:LOCAL:chat:
        )
        
        # ConversationBufferMemoryì— ì—°ê²°
        self._session_mem[session_id] = ConversationBufferMemory(
            chat_memory=history,
            return_messages=True
        )
```

---

## ğŸ”„ LLM ì„œë¹„ìŠ¤ ì „ì²´ íë¦„

### **1. ì„œë¹„ìŠ¤ ì´ˆê¸°í™”**
```
1. ServiceContainerì—ì„œ AIChatService ì¸ìŠ¤í„´ìŠ¤ ìƒì„±
2. LlmConfigë¥¼ í†µí•œ LLM ì„¤ì • ë¡œë“œ
3. OpenAI API í‚¤ ë° ëª¨ë¸ ì„¤ì •
4. Redis ìºì‹œ ì„œë¹„ìŠ¤ ì—°ê²° í™•ì¸
5. ê¸ˆìœµ ë¶„ì„ ë„êµ¬ë“¤ ì´ˆê¸°í™”
```

### **2. REST API ì±„íŒ… í”Œë¡œìš°**
```
1. ì‚¬ìš©ì ë©”ì‹œì§€ ìˆ˜ì‹  (/api/chat)
2. AIChatService.chat() ë©”ì„œë“œ í˜¸ì¶œ
3. ì„¸ì…˜ ID ìƒì„± ë˜ëŠ” ê¸°ì¡´ ì„¸ì…˜ ì‚¬ìš©
4. AIChatRouterë¥¼ í†µí•œ ë„êµ¬ ì²´ì¸ ì‹¤í–‰
5. LangGraph íŒŒì´í”„ë¼ì¸ìœ¼ë¡œ ë¶„ì„ ìˆ˜í–‰
6. Redisì— ëŒ€í™” íˆìŠ¤í† ë¦¬ ì €ì¥
7. ìµœì¢… ì‘ë‹µ ë°˜í™˜
```

### **3. WebSocket ìŠ¤íŠ¸ë¦¬ë° í”Œë¡œìš°**
```
1. WebSocket ì—°ê²° ìˆ˜ë¦½
2. AIChatService.stream() ë©”ì„œë“œ í˜¸ì¶œ
3. ì‹¤ì‹œê°„ ë©”ì‹œì§€ ìˆ˜ì‹  ë° ì²˜ë¦¬
4. ìŠ¤íŠ¸ë¦¬ë° LLMì„ í†µí•œ ì‘ë‹µ ìƒì„±
5. WebSocketì„ í†µí•œ ì‹¤ì‹œê°„ ì‘ë‹µ ì „ì†¡
6. ì—°ê²° ì¢…ë£Œ ì‹œ ì •ë¦¬ ì‘ì—…
```

### **4. ë„êµ¬ ì²´ì¸ ì‹¤í–‰ í”Œë¡œìš°**
```
1. ì‚¬ìš©ì ì§ˆë¬¸ ë¶„ì„
2. ì ì ˆí•œ ê¸ˆìœµ ë¶„ì„ ë„êµ¬ ì„ íƒ
3. ë„êµ¬ë³„ ì…ë ¥ íŒŒë¼ë¯¸í„° ì¤€ë¹„
4. ìˆœì°¨ì  ë„êµ¬ ì‹¤í–‰ ë° ê²°ê³¼ ìˆ˜ì§‘
5. ì¤‘ê°„ ê²°ê³¼ ê²€ì¦ ë° ì—ëŸ¬ ì²˜ë¦¬
6. ìµœì¢… ì‘ë‹µ í†µí•© ë° í¬ë§·íŒ…
```

---

## ğŸ”Œ ë„êµ¬ ì²´ì¸ êµ¬í˜„ ìƒì„¸

### **ê¸ˆìœµ ë„êµ¬ í™•ì¥ ê°€ì´ë“œ (`BaseFinanceTool` ìƒì†)**

ëª¨ë“  ê¸ˆìœµ ë¶„ì„ ë„êµ¬ëŠ” `BaseFinanceTool`ì„ ìƒì†ë°›ì•„ ì¼ê´€ëœ ì¸í„°í˜ì´ìŠ¤ë¥¼ ìœ ì§€í•´ì•¼ í•©ë‹ˆë‹¤. ì´ëŠ” LangGraph ë¼ìš°í„°ê°€ ê° ë„êµ¬ë¥¼ ë™ì ìœ¼ë¡œ ì‹ë³„í•˜ê³  ì‹¤í–‰í•˜ê¸° ìœ„í•´ í•„ìˆ˜ì ì…ë‹ˆë‹¤.

```python
# AIChat/BaseFinanceTool.py
from pydantic import BaseModel, Field

class BaseFinanceTool(BaseModel):
    name: str = Field(..., description="ë„êµ¬ì˜ ê³ ìœ í•œ ì´ë¦„")
    description: str = Field(..., description="LLMì´ ë„êµ¬ì˜ ìš©ë„ë¥¼ ì´í•´í•˜ê¸° ìœ„í•œ ì„¤ëª…")

    def run(self, params: BaseModel) -> str:
        """ë„êµ¬ì˜ ì‹¤ì œ ì‹¤í–‰ ë¡œì§"""
        raise NotImplementedError("ì´ ë©”ì„œë“œëŠ” ì„œë¸Œí´ë˜ìŠ¤ì—ì„œ êµ¬í˜„ë˜ì–´ì•¼ í•©ë‹ˆë‹¤.")

# ì„¸ì…˜ ì •ë³´ê°€ í•„ìš”í•œ ê²½ìš° SessionAwareToolì„ ìƒì†
class SessionAwareTool(BaseFinanceTool):
    client_session: object = Field(None, description="ì‚¬ìš©ì ì„¸ì…˜ ì •ë³´")
```

**ìƒˆë¡œìš´ ë„êµ¬ ì¶”ê°€ ì˜ˆì‹œ (`MyNewTool.py`)**
```python
import json
from pydantic import BaseModel, Field
from .BaseFinanceTool import BaseFinanceTool

# 1. ë„êµ¬ì˜ ì…ë ¥ íŒŒë¼ë¯¸í„°ë¥¼ Pydantic ëª¨ë¸ë¡œ ì •ì˜
class MyToolParams(BaseModel):
    symbol: str = Field(..., description="ë¶„ì„í•  ì£¼ì‹ ì‹¬ë³¼")
    period: int = Field(14, description="ë¶„ì„ ê¸°ê°„(ì¼)")

# 2. BaseFinanceToolì„ ìƒì†í•˜ì—¬ ìƒˆ ë„êµ¬ í´ë˜ìŠ¤ ìƒì„±
class MyNewTool(BaseFinanceTool):
    def __init__(self):
        super().__init__(
            name="my_new_tool_analyzer",
            description="ìƒˆë¡œìš´ ë¶„ì„ì„ ìˆ˜í–‰í•˜ëŠ” ë„êµ¬ì…ë‹ˆë‹¤. íŠ¹ì • ì‹¬ë³¼ê³¼ ê¸°ê°„ì„ ë°›ì•„ ë¶„ì„ ê²°ê³¼ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤."
        )

    # 3. run ë©”ì„œë“œ êµ¬í˜„
    def run(self, params: MyToolParams) -> str:
        """ë„êµ¬ì˜ í•µì‹¬ ë¡œì§"""
        try:
            # ì—¬ê¸°ì— ì‹¤ì œ ë¶„ì„ ë¡œì§ êµ¬í˜„
            # ì˜ˆ: ì™¸ë¶€ API í˜¸ì¶œ, ë°ì´í„° ë¶„ì„ ë“±
            analysis_result = {
                "symbol": params.symbol,
                "period": params.period,
                "result": "ë§¤ìš° ê¸ì •ì ",
                "confidence": 0.95
            }
            
            # 4. ê²°ê³¼ë¥¼ JSON ë¬¸ìì—´ë¡œ ë°˜í™˜
            return json.dumps(analysis_result, ensure_ascii=False)
        
        except Exception as e:
            # ì—ëŸ¬ ì²˜ë¦¬
            return json.dumps({"error": f"ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {str(e)}"})

```

### **ë„êµ¬ ì¶œë ¥ í¬ë§· (Tool Output Format)**

- **ë°˜í™˜ íƒ€ì…**: ëª¨ë“  ë„êµ¬ì˜ `run` ë©”ì„œë“œëŠ” ìµœì¢…ì ìœ¼ë¡œ **ë¬¸ìì—´(string)**ì„ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤.
- **ë°ì´í„° êµ¬ì¡°**: ë³µì¡í•œ ë¶„ì„ ê²°ê³¼ëŠ” **JSON í˜•ì‹ì˜ ë¬¸ìì—´**ë¡œ ë³€í™˜í•˜ì—¬ ë°˜í™˜í•˜ëŠ” ê²ƒì„ ê°•ë ¥íˆ ê¶Œì¥í•©ë‹ˆë‹¤. LLMì€ êµ¬ì¡°í™”ëœ JSONì„ íŒŒì‹±í•˜ì—¬ ì‚¬ìš©ìì—ê²Œ ë” í’ë¶€í•˜ê³  ì •í™•í•œ ë‹µë³€ì„ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**ì¢‹ì€ ì¶œë ¥ ì˜ˆì‹œ:**
```json
{
  "status": "success",
  "analysis_type": "ê¸°ìˆ ì  ë¶„ì„ (RSI)",
  "data": {
    "symbol": "AAPL",
    "current_rsi": 68.5,
    "signal": "ê³¼ë§¤ìˆ˜ êµ¬ê°„ì— ê·¼ì ‘. ë‹¨ê¸° ì¡°ì • ê°€ëŠ¥ì„± ìˆìŒ.",
    "recommendation": "HOLD"
  },
  "generated_at": "2025-01-20T10:30:00Z"
}
```

---

## ğŸ”¬ ê³ ê¸‰ ë¶„ì„ ë„êµ¬ ì‹¬ì¸µ ë¶„ì„: `KalmanRegimeFilterTool`

`KalmanRegimeFilterTool`ì€ ì´ í”Œë«í¼ì˜ ëŒ€í‘œì ì¸ ê³ ê¸‰ ë¶„ì„ ë„êµ¬ë¡œ, **5ì°¨ì› ì¹¼ë§Œ í•„í„°**ì™€ **ë¸”ë™-ìˆ„ì¦ˆ ì˜µì…˜ ê°€ê²© ê³„ì‚°**ì„ ê²°í•©í•˜ì—¬ ì‹¤ì‹œê°„ íŠ¸ë ˆì´ë”© ì‹ í˜¸ë¥¼ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

### **1. ê°œìš”**
ì´ ë„êµ¬ëŠ” **FeaturePipelineTool**ì„ í†µí•´ OHLCV, ê²½ì œì§€í‘œ, ê¸°ìˆ ì  ì§€í‘œ ë“±ì˜ ì›ì‹œ ë°ì´í„°ë¥¼ ìˆ˜ì§‘í•˜ê³ , ì´ë¥¼ **5ì°¨ì› ê´€ì¸¡ ë²¡í„°**ë¡œ ë³€í™˜í•˜ì—¬ ì¹¼ë§Œ í•„í„°ì— ì…ë ¥í•©ë‹ˆë‹¤. ì¹¼ë§Œ í•„í„°ëŠ” ë…¸ì´ì¦ˆë¥¼ ì œê±°í•˜ê³  ìˆ¨ê²¨ì§„ ì¶”ì„¸ë¥¼ ì¶”ì •í•œ í›„, ë¸”ë™-ìˆ„ì¦ˆ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ ATM ê¸°ë°˜ ì˜µì…˜ ì´ë¡ ê°€ë¥¼ ê³„ì‚°í•˜ê³  ì‹¤ì œ ì‹œì¥ê°€ì™€ ë¹„êµí•˜ì—¬ ë§¤ìˆ˜/ë§¤ë„/ê´€ë§ ì‹ í˜¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.

### **2. í•µì‹¬ ì•„í‚¤í…ì²˜ ë° ë°ì´í„° í”Œë¡œìš°**

#### **2.1 ë°ì´í„° ìˆ˜ì§‘ ë° ì „ì²˜ë¦¬**
```
1. FeaturePipelineTool í˜¸ì¶œ
   â”œâ”€â”€ ê¸°ë³¸ í”¼ì²˜: GDP, CPIAUCSL, DEXKOUS, RSI, MACD, VIX, PRICE
   â”œâ”€â”€ ì •ê·œí™”: ëª¨ë“  í”¼ì²˜ë¥¼ [-5, 5] ë²”ìœ„ë¡œ ìŠ¤ì¼€ì¼ë§
   â””â”€â”€ ë³µí•© í”¼ì²˜ ìƒì„±: 5ì°¨ì› ì¹¼ë§Œ í•„í„° ì „ìš© ê³µì‹ ì ìš©

2. 5ì°¨ì› ê´€ì¸¡ ë²¡í„° êµ¬ì„±
   â”œâ”€â”€ kalman_trend: ê±°ì‹œê²½ì œ + ë³€ë™ì„± ë³µí•© (GDP 0.1% + CPI 1% + VIX 98.9%)
   â”œâ”€â”€ kalman_momentum: ê¸°ìˆ ì  + ê±°ì‹œê²½ì œ ë³µí•© (RSI 70% + MACD 25% + CPI 5%)
   â”œâ”€â”€ kalman_volatility: VIX ë³€ë™ì„± (100%)
   â”œâ”€â”€ kalman_macro: ê±°ì‹œê²½ì œ ì‹ í˜¸ (GDP 0.1% + CPI 99.9%)
   â””â”€â”€ kalman_tech: ê¸°ìˆ ì  ì‹ í˜¸ (RSI 60% + MACD 40%)
```

#### **2.2 ì¹¼ë§Œ í•„í„° ìƒíƒœ ê´€ë¦¬**
```
ìƒíƒœ ë²¡í„°: [trend, momentum, volatility, macro_signal, tech_signal]
â”œâ”€â”€ Redis + SQL í•˜ì´ë¸Œë¦¬ë“œ ì €ì¥
â”œâ”€â”€ ì‚¬ìš©ìë³„ ì„¸ì…˜ ê¸°ë°˜ í•„í„° ì¸ìŠ¤í„´ìŠ¤ ê´€ë¦¬
â”œâ”€â”€ ë§¤ í˜¸ì¶œë§ˆë‹¤ ìƒíƒœ ë³µì› ë° ì—…ë°ì´íŠ¸
â””â”€â”€ ì„±ëŠ¥ ë©”íŠ¸ë¦­ ëª¨ë‹ˆí„°ë§ (innovation, divergence ê°ì§€)
```

#### **2.3 ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²© ë¶„ì„**
```
1. í˜„ì¬ê°€ ê¸°ì¤€ í–‰ì‚¬ê°€ ê·¸ë¦¬ë“œ ìƒì„±
   â”œâ”€â”€ í˜„ì¬ê°€ ê¸°ì¤€ Â±5%, Â±10% í–‰ì‚¬ê°€ (ì˜ˆ: í˜„ì¬ê°€ $100ì´ë©´ $95, $100, $105, $110)
   â”œâ”€â”€ ê° í–‰ì‚¬ê°€ë³„ ì´ë¡ ê°€ ê³„ì‚° (ìˆ˜í•™ì  ê³µì‹ìœ¼ë¡œ ì •í™•í•œ ê°€ê²© ë„ì¶œ)
   â””â”€â”€ ë¯¼ê°ë„ ì§€í‘œ ê³„ì‚° (ê°€ê²© ë³€í™”ì— ë”°ë¥¸ ì˜µì…˜ ê°€ì¹˜ ë³€í™”ìœ¨)

2. ì´ë¡ ê°€ vs ì‹œì¥ê°€ ë¹„êµ ë¶„ì„
   â”œâ”€â”€ ì´ë¡ ê°€ê°€ ì‹œì¥ê°€ë³´ë‹¤ ë†’ìœ¼ë©´ â†’ "ì‹œì¥ê°€ê°€ ì‹¸ë‹¤" â†’ ë§¤ìˆ˜ ì‹ í˜¸
   â”œâ”€â”€ ì´ë¡ ê°€ê°€ ì‹œì¥ê°€ë³´ë‹¤ ë‚®ìœ¼ë©´ â†’ "ì‹œì¥ê°€ê°€ ë¹„ì‹¸ë‹¤" â†’ ë§¤ë„ ì‹ í˜¸
   â””â”€â”€ ì°¨ì´ê°€ ì ìœ¼ë©´ â†’ "ì ì •ê°€" â†’ ê´€ë§

3. ì¹¼ë§Œ í•„í„° ë°©í–¥ì„±ê³¼ ì •í•©ì„± ì²´í¬
   â”œâ”€â”€ ì¹¼ë§Œì´ "ìƒìŠ¹ ì˜ˆìƒ" + ê°€ê²©ì´ "ë§¤ìˆ˜ ì‹ í˜¸" = ì™„ë²½í•œ ì¡°í•© âœ…
   â”œâ”€â”€ ì¹¼ë§Œì´ "í•˜ë½ ì˜ˆìƒ" + ê°€ê²©ì´ "ë§¤ë„ ì‹ í˜¸" = ì™„ë²½í•œ ì¡°í•© âœ…
   â””â”€â”€ ë°©í–¥ì„±ì´ ë‹¤ë¥´ë©´ â†’ ì‹ ì¤‘í•œ ì ‘ê·¼ í•„ìš” âš ï¸

4. ìµœì¢… ì•¡ì…˜ ê²°ì • (ë ˆë²„ë¦¬ì§€ ì—†ì´ í˜„ë¬¼ ë§¤ìˆ˜/ë§¤ë„ ê°œë…)
   â”œâ”€â”€ ë§¤ìˆ˜: ì´ë¡ ê°€ ëŒ€ë¹„ ì‹¼ ê°€ê²©ì„ ì‚¬ì„œ ìƒìŠ¹ ì‹œ ìˆ˜ìµ ì‹¤í˜„
   â”œâ”€â”€ ë§¤ë„: ì´ë¡ ê°€ ëŒ€ë¹„ ë¹„ì‹¼ ê°€ê²©ì„ íŒ”ì•„ì„œ í•˜ë½ ì‹œ ìˆ˜ìµ ì‹¤í˜„
   â””â”€â”€ ê´€ë§: ì ì •ê°€ ë²”ìœ„ì´ê±°ë‚˜ ë¶ˆí™•ì‹¤ì„±ì´ ë†’ì€ ê²½ìš°
```

### **3. ì‹¤ì œ êµ¬í˜„ëœ ë™ì‘ ê³¼ì •**

#### **3.1 ë°ì´í„° íŒŒì´í”„ë¼ì¸ ì‹¤í–‰**
```python
# FeaturePipelineToolì„ í†µí•œ ë°ì´í„° ìˆ˜ì§‘ ë° ì •ê·œí™”
pipeline_result = FeaturePipelineTool(self.ai_chat_service).transform(
    tickers=inp.tickers,
    start_date=inp.start_date,
    end_date=inp.end_date,
    feature_set=["GDP", "CPIAUCSL", "DEXKOUS", "RSI", "MACD", "VIX", "PRICE"],
    normalize=True,  # ì •ê·œí™” í™œì„±í™”
    normalize_targets=["GDP", "CPIAUCSL", "VIX", "RSI", "MACD"],
    generate_composites=True,  # ë³µí•© í”¼ì²˜ ìƒì„±
    composite_formula_map=kalman_composite_formulas,  # 5ì°¨ì› ì¹¼ë§Œ ì „ìš© ê³µì‹
    return_raw=True,  # Raw + Normalized ë™ì‹œ ë°˜í™˜
    debug=debug
)
```

#### **3.2 5ì°¨ì› ê´€ì¸¡ ë²¡í„° êµ¬ì„±**
```python
# 5ì°¨ì› ì¹¼ë§Œ í•„í„°ìš© ê´€ì¸¡ ë²¡í„°
z = np.array([
    norm_features.get("kalman_trend", 0.0),      # trend
    norm_features.get("kalman_momentum", 0.0),   # momentum
    norm_features.get("kalman_volatility", 0.0), # volatility
    norm_features.get("kalman_macro", 0.0),      # macro_signal
    norm_features.get("kalman_tech", 0.0)        # tech_signal
])
```

#### **3.3 ì¹¼ë§Œ í•„í„° ìƒíƒœ ë³µì› ë° ì‹¤í–‰**
```python
# Redis + SQL í•˜ì´ë¸Œë¦¬ë“œ ìƒíƒœ ê´€ë¦¬
if self.state_manager:
    # 1. SQLì—ì„œ ìµœì‹  ìƒíƒœ ë³µì›
    filter_instance = restore_from_sql_sync()
    
    if filter_instance is None:
        # 2. Rule-Based ì´ˆê¸°í™” (KalmanInitializerTool ì‚¬ìš©)
        initializer = KalmanInitializerTool()
        x, P = initializer.initialize_kalman_state(ticker)
        
        filter_instance = KalmanRegimeFilterCore()
        filter_instance.x = x
        filter_instance.P = P
        filter_instance.step_count = 0

# ì¹¼ë§Œ í•„í„° ì‹¤í–‰
filter_instance.step(z)
state, cov = filter_instance.x.copy(), filter_instance.P.copy()
```

#### **3.4 ë¸”ë™-ìˆ„ì¦ˆ ê°€ê²© ë·° ìƒì„±**
```python
# ë¸”ë™-ìˆ„ì¦ˆ ì…ë ¥ íŒŒë¼ë¯¸í„° ìƒì„±
bs_inputs = self._build_bs_inputs(
    entry_price=entry_price,        # í˜„ì¬ ì£¼ì‹ ê°€ê²©
    atr_pct=atr_pct,               # ì¼ê°„ ë³€ë™ì„±
    rate=0.02,                     # ë¬´ìœ„í—˜ì´ììœ¨ (ì—° 2%)
    div_yield=0.0,                 # ë°°ë‹¹ìˆ˜ìµë¥  (0%)
    days_to_expiry=inp.horizon_days # ë§Œê¸°ê¹Œì§€ ì¼ìˆ˜
)

# ê°€ê²© ë·° ì¶”ê°€ (ì´ë¡ ê°€, ë¯¼ê°ë„ ì§€í‘œ, ì‹œì¥ê°€ ë¹„êµ)
self._attach_option_view(rec, bs_inputs, signal, market_prices, threshold)
```

### **4. íŠ¸ë ˆì´ë”© ì‹ í˜¸ ìƒì„± ë¡œì§**

#### **4.1 ì¢…í•© ì‹ í˜¸ ê³„ì‚°**
```python
# 5ì°¨ì› ìƒíƒœë¥¼ ì¢…í•© ì‹ í˜¸ë¡œ ë³€í™˜
trend = state[0]        # ì¶”ì„¸
momentum = state[1]     # ëª¨ë©˜í…€
macro_signal = state[3] # ê±°ì‹œê²½ì œ ì‹ í˜¸
tech_signal = state[4]  # ê¸°ìˆ ì  ì‹ í˜¸

# ê°€ì¤‘ í‰ê· ìœ¼ë¡œ ì¢…í•© ì‹ í˜¸ ê³„ì‚°
combined_signal = 0.4 * trend + 0.3 * momentum + 0.2 * macro_signal + 0.1 * tech_signal
combined_signal = np.clip(combined_signal, -5.0, 5.0)  # ë²”ìœ„ ì œí•œ

# ì‹ í˜¸ ë°©í–¥ ê²°ì •
if combined_signal > 0.5:
    signal = "Long"      # ë§¤ìˆ˜ ì‹ í˜¸
elif combined_signal < -0.5:
    signal = "Short"     # ë§¤ë„ ì‹ í˜¸
else:
    signal = "Neutral"   # ê´€ë§
```

#### **4.2 ì‹œì¥ê°€ ë¹„êµ ì‹ í˜¸**
```python
# ì‹œì¥ê°€ê°€ ì œê³µëœ ê²½ìš° ì´ë¡ ê°€ì™€ ë¹„êµ
if market_prices:
    raw_signals = self._analyze_option_signals(bs_inputs, market_prices, threshold, signal)
    
    # ì¹¼ë§Œ ë°©í–¥ì„±ê³¼ ì •í•©ì„± ì²´í¬
    bias_ok = (
        (bias == "Long" and action == "ë§¤ìˆ˜") or 
        (bias == "Short" and action == "ë§¤ë„") or 
        (bias == "Neutral")
    )
    
    # ìš°ì„ ìˆœìœ„ ì •ë ¬: ë°©í–¥ì„± ì¼ì¹˜ ìš°ì„  â†’ í¸ì°¨ê°€ í° ìˆœ
    signals.sort(key=lambda s: (not s["bias_ok"], -abs(s["ratio"])))
```

### **5. ì‚¬ìš©ì ì§ˆë¬¸ ê¸°ë°˜ ì§€ì†ì  í•™ìŠµ**

#### **5.1 ìƒíƒœ ì§€ì†ì„±**
- **ë§¤ í˜¸ì¶œë§ˆë‹¤ ìƒˆë¡œìš´ í•„í„° ìƒíƒœ**: ì‚¬ìš©ìê°€ ì§ˆë¬¸í•  ë•Œë§ˆë‹¤ ì¹¼ë§Œ í•„í„°ê°€ ìƒˆë¡œìš´ ê´€ì¸¡ ë²¡í„°ë¡œ ì—…ë°ì´íŠ¸
- **Redis + SQL ì´ì¤‘ ì €ì¥**: ì‹¤ì‹œê°„ ì ‘ê·¼ì„±ê³¼ ì˜ì†ì„± ë³´ì¥
- **ì„±ëŠ¥ ë©”íŠ¸ë¦­ ì¶”ì **: innovation history, divergence ê°ì§€, step_count ëª¨ë‹ˆí„°ë§

#### **5.2 ì ì§„ì  ì •êµí™”**
```
1. ì²« ë²ˆì§¸ í˜¸ì¶œ: Rule-Based ì´ˆê¸°í™”
2. ë‘ ë²ˆì§¸ í˜¸ì¶œ: ì´ì „ ìƒíƒœ ë³µì› + ìƒˆë¡œìš´ ê´€ì¸¡ìœ¼ë¡œ ì—…ë°ì´íŠ¸
3. Në²ˆì§¸ í˜¸ì¶œ: N-1ë²ˆì§¸ ìƒíƒœ + ìµœì‹  ê´€ì¸¡ìœ¼ë¡œ ì •êµí™”
4. ê²°ê³¼: ë” ì •í™•í•œ ì¶”ì„¸ ì¶”ì • ë° ì‹ ë¢°ë„ í–¥ìƒ
```

### **6. LLMê³¼ì˜ ì—°ê³„ ë° ìµœì¢… ì¶œë ¥**

#### **6.1 ë„êµ¬ ì¶œë ¥ (êµ¬ì¡°í™”ëœ JSON)**
```json
{
  "trading_signal": "Long",
  "strategy": "Trend Following",
  "signal_confidence": "ë†’ìŒ (85.2%)",
  "combined_signal": "ê°•í•¨ (2.847) - ê°•í•œ ì‹ í˜¸ (ì ê·¹ì  ì§„ì…) (ë§¤ìˆ˜ ì‹ í˜¸)",
  "position_size": 15.234,
  "leverage": "ë…¸ì¶œ 23%",
  "options": {
    "spot": 340.84,
    "sigma_annual": 0.456,
    "view": "call/put grid by strikes",
    "preferred": "call",
    "table": [
      {
        "K": 306.76, "call": 35.0, "put": 0.8,
        "delta": 0.987, "gamma": 0.001, "vega": 12.5, "theta": -0.8, "rho": 0.2
      }
    ]
  },
  "stop_loss": "$325.50",
  "take_profit": "$365.20"
}
```

#### **6.2 LLMì˜ ìì—°ì–´ í•´ì„**
LLMì€ ìœ„ì˜ êµ¬ì¡°í™”ëœ JSONì„ ë°›ì•„ ë‹¤ìŒê³¼ ê°™ì´ ìì—°ìŠ¤ëŸ¬ìš´ íˆ¬ì ì¡°ì–¸ì„ ìƒì„±í•©ë‹ˆë‹¤:

> "ì¹¼ë§Œ í•„í„° ë¶„ì„ ê²°ê³¼, í˜„ì¬ í…ŒìŠ¬ë¼ëŠ” **ê°•í•œ ë§¤ìˆ˜ ì‹ í˜¸**ë¥¼ ë³´ì´ê³  ìˆìŠµë‹ˆë‹¤. 5ì°¨ì› ìƒíƒœ ë¶„ì„ì—ì„œ ì¶”ì„¸(2.1), ëª¨ë©˜í…€(1.8), ê¸°ìˆ ì  ì‹ í˜¸(1.5)ê°€ ëª¨ë‘ ìƒìŠ¹ ë°©í–¥ì´ë©°, 85.2%ì˜ ë†’ì€ ì‹ ë¢°ë„ë¥¼ ë³´ì…ë‹ˆë‹¤. ë¸”ë™-ìˆ„ì¦ˆ ì˜µì…˜ ë¶„ì„ì— ë”°ë¥´ë©´ ATM ì½œ ì˜µì…˜ì´ í˜„ì¬ ì‹œì¥ê°€ ëŒ€ë¹„ 5% ì €í‰ê°€ë˜ì–´ ìˆì–´ ë§¤ìˆ˜ ê¸°íšŒë¡œ íŒë‹¨ë©ë‹ˆë‹¤. ì†ì ˆê°€ëŠ” $325.50, ëª©í‘œê°€ëŠ” $365.20ìœ¼ë¡œ ì„¤ì •í•˜ëŠ” ê²ƒì„ ê¶Œì¥í•©ë‹ˆë‹¤."

### **7. í•µì‹¬ íŠ¹ì§• ë° ì¥ì **

#### **7.1 ì‹¤ì‹œê°„ ì ì‘ì„±**
- **ë§¤ í˜¸ì¶œë§ˆë‹¤ ìƒíƒœ ì—…ë°ì´íŠ¸**: ìƒˆë¡œìš´ ì‹œì¥ ë°ì´í„°ë¡œ ì§€ì†ì  í•™ìŠµ
- **ë™ì  ì‹ ë¢°ë„ ì¡°ì •**: ê´€ì¸¡ ë°ì´í„° í’ˆì§ˆì— ë”°ë¥¸ ì‹ ë¢°ë„ ìë™ ì¡°ì •
- **ì ì‘í˜• ì„ê³„ê°’**: ì‹œì¥ ìƒí™©ì— ë”°ë¥¸ ë™ì  ì‹ í˜¸ ì„ê³„ê°’ ì¡°ì •

#### **7.2 ë‹¤ì°¨ì› ë¶„ì„**
- **5ì°¨ì› ìƒíƒœ ë²¡í„°**: ì¶”ì„¸, ëª¨ë©˜í…€, ë³€ë™ì„±, ê±°ì‹œê²½ì œ, ê¸°ìˆ ì  ì‹ í˜¸ë¥¼ ë…ë¦½ì ìœ¼ë¡œ ëª¨ë¸ë§
- **ë³µí•© í”¼ì²˜ ìƒì„±**: ë‹¨ì¼ ì§€í‘œì˜ í•œê³„ë¥¼ ê·¹ë³µí•˜ëŠ” ë³µí•© ì‹ í˜¸ ìƒì„±
- **êµì°¨ ê²€ì¦**: ì—¬ëŸ¬ ì°¨ì›ì˜ ì‹ í˜¸ê°€ ì¼ì¹˜í•  ë•Œ ì‹ ë¢°ë„ í–¥ìƒ

#### **7.3 ê°€ê²© ì „ëµ í†µí•©**
- **í˜„ì¬ê°€ ê¸°ì¤€ ë¶„ì„**: í˜„ì¬ê°€ ê¸°ì¤€ í˜„ì‹¤ì ì¸ ê°€ê²© ì „ëµ ì œì‹œ
- **ì‹œì¥ê°€ ë¹„êµ**: ì´ë¡ ê°€ ëŒ€ë¹„ ì‹¤ì œ ì‹œì¥ê°€ í¸ì°¨ ë¶„ì„
- **ë¦¬ìŠ¤í¬ ê´€ë¦¬**: ì†ì ˆê°€/ëª©í‘œê°€ ìë™ ê³„ì‚° ë° í¬ì§€ì…˜ í¬ê¸° ìµœì í™”

ì´ ë„êµ¬ëŠ” ë‹¨ìˆœí•œ ê¸°ìˆ ì  ë¶„ì„ì„ ë„˜ì–´ì„œ **ê±°ì‹œê²½ì œ, ê¸°ìˆ ì  ì§€í‘œ, ë³€ë™ì„±, ê°€ê²© ë¶„ì„**ì„ í†µí•©ì ìœ¼ë¡œ ë¶„ì„í•˜ì—¬ **ì‹¤í–‰ ê°€ëŠ¥í•œ íŠ¸ë ˆì´ë”© ì „ëµ**ì„ ì œê³µí•˜ëŠ” ê³ ë„í™”ëœ AI ê¸ˆìœµ ë¶„ì„ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

---

## ğŸ¯ ì½”ë“œ ì² í•™

### **1. ëª¨ë“ˆí™” ë° í™•ì¥ì„±**
- **ë„êµ¬ ê¸°ë°˜ ì•„í‚¤í…ì²˜**: ìƒˆë¡œìš´ ë¶„ì„ ë„êµ¬ë¥¼ ì‰½ê²Œ ì¶”ê°€ ê°€ëŠ¥
- **í”ŒëŸ¬ê·¸ì¸ êµ¬ì¡°**: ë„êµ¬ë³„ ë…ë¦½ì ì¸ ê°œë°œ ë° ë°°í¬
- **ì¸í„°í˜ì´ìŠ¤ í‘œì¤€í™”**: BaseFinanceToolì„ í†µí•œ ì¼ê´€ëœ ë„êµ¬ êµ¬ì¡°

### **2. ì„±ëŠ¥ ë° ì•ˆì •ì„±**
- **ë¹„ë™ê¸° ì²˜ë¦¬**: asyncioë¥¼ í†µí•œ ë™ì‹œì„± ì²˜ë¦¬
- **ìºì‹± ì „ëµ**: Redisë¥¼ í†µí•œ ëŒ€í™” íˆìŠ¤í† ë¦¬ ë° ê²°ê³¼ ìºì‹±
- **ì—ëŸ¬ ì²˜ë¦¬**: ë„êµ¬ë³„ ì˜ˆì™¸ ì²˜ë¦¬ ë° ë³µêµ¬ ë©”ì»¤ë‹ˆì¦˜

### **3. ì‚¬ìš©ì ê²½í—˜**
- **ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ**: ì‹¤ì‹œê°„ AI ì‘ë‹µìœ¼ë¡œ ì¦‰ì‹œì„± ì œê³µ
- **ì„¸ì…˜ ê´€ë¦¬**: ì‚¬ìš©ìë³„ ëŒ€í™” ì»¨í…ìŠ¤íŠ¸ ìœ ì§€
- **ë„êµ¬ ì„¤ëª…**: ê° ë„êµ¬ì˜ ê¸°ëŠ¥ê³¼ ì‚¬ìš©ë²•ì„ ëª…í™•íˆ ì œì‹œ

### **4. ê°œë°œì ê²½í—˜**
- **íƒ€ì… íŒíŠ¸**: Python íƒ€ì… íŒíŠ¸ë¥¼ í†µí•œ ì½”ë“œ ê°€ë…ì„±
- **ì„¤ì • ê´€ë¦¬**: Pydanticì„ í†µí•œ ì„¤ì • ê²€ì¦ ë° ê´€ë¦¬
- **ë¡œê¹…**: êµ¬ì¡°í™”ëœ ë¡œê¹…ì„ í†µí•œ ë””ë²„ê¹… ì§€ì›

---

## ğŸš€ ê°œì„ í•  ì 

### **1. ì„±ëŠ¥ ìµœì í™”**
- [ ] **ë³‘ë ¬ ì²˜ë¦¬**: ë„êµ¬ ì²´ì¸ì˜ ë³‘ë ¬ ì‹¤í–‰ìœ¼ë¡œ ì‘ë‹µ ì‹œê°„ ë‹¨ì¶•
- [ ] **ë°°ì¹˜ ì²˜ë¦¬**: ì—¬ëŸ¬ ìš”ì²­ì„ ë¬¶ì–´ì„œ ì²˜ë¦¬í•˜ëŠ” ë°°ì¹˜ ì‹œìŠ¤í…œ
- [ ] **ë©”ëª¨ë¦¬ ìµœì í™”**: ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì‹œ ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ìµœì í™”

### **2. ê¸°ëŠ¥ í™•ì¥**
- [ ] **ë©€í‹° ëª¨ë¸ ì§€ì›**: OpenAI ì™¸ ë‹¤ë¥¸ LLM í”„ë¡œë°”ì´ë” ì¶”ê°€
- [ ] **ì»¤ìŠ¤í…€ ë„êµ¬**: ì‚¬ìš©ì ì •ì˜ ë¶„ì„ ë„êµ¬ ìƒì„± ê¸°ëŠ¥
- [ ] **í•™ìŠµ ê¸°ëŠ¥**: ì‚¬ìš©ì í”¼ë“œë°±ì„ í†µí•œ ì‘ë‹µ í’ˆì§ˆ ê°œì„ 

### **3. ë³´ì•ˆ ê°•í™”**
- [ ] **API í‚¤ ê´€ë¦¬**: í™˜ê²½ ë³€ìˆ˜ ë° ì‹œí¬ë¦¿ ê´€ë¦¬ ì‹œìŠ¤í…œ
- [ ] **ìš”ì²­ ì œí•œ**: Rate limiting ë° ì‚¬ìš©ëŸ‰ ì œí•œ
- [ ] **ì…ë ¥ ê²€ì¦**: ì‚¬ìš©ì ì…ë ¥ì— ëŒ€í•œ ë³´ì•ˆ ê²€ì¦ ê°•í™”

### **4. ëª¨ë‹ˆí„°ë§ ë° ê´€ì¸¡ì„±**
- [ ] **ì„±ëŠ¥ ë©”íŠ¸ë¦­**: ì‘ë‹µ ì‹œê°„, ì²˜ë¦¬ëŸ‰, ì—ëŸ¬ìœ¨ ì¸¡ì •
- [ ] **ì‚¬ìš©ëŸ‰ ì¶”ì **: API í˜¸ì¶œ íŒ¨í„´ ë° ì‚¬ìš©ì í–‰ë™ ë¶„ì„
- [ ] **ì•Œë¦¼ ì‹œìŠ¤í…œ**: ì‹œìŠ¤í…œ ì¥ì•  ë° ì„±ëŠ¥ ì €í•˜ ì‹œ ì•Œë¦¼

### **5. í…ŒìŠ¤íŠ¸ ë° í’ˆì§ˆ**
- [ ] **ë‹¨ìœ„ í…ŒìŠ¤íŠ¸**: ê° ë„êµ¬ë³„ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì‘ì„±
- [ ] **í†µí•© í…ŒìŠ¤íŠ¸**: ì „ì²´ íŒŒì´í”„ë¼ì¸ í†µí•© í…ŒìŠ¤íŠ¸
- [ ] **ì„±ëŠ¥ í…ŒìŠ¤íŠ¸**: ë¶€í•˜ í…ŒìŠ¤íŠ¸ ë° ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬

---

### **ì˜ì¡´ì„± ì„¤ì¹˜**
```bash
# requirements.txt ê¸°ë°˜ ì„¤ì¹˜
pip install -r AIChat/requirements.txt

# ë˜ëŠ” ê°œë³„ ì„¤ì¹˜
pip install langchain langgraph openai redis fastapi
```

### **Redis ì„¤ì •**
```bash
# Redis ì„œë²„ ì‹¤í–‰
redis-server

# Redis í´ë¼ì´ì–¸íŠ¸ í…ŒìŠ¤íŠ¸
redis-cli ping
```

---

## ğŸ“š ì¶”ê°€ ë¦¬ì†ŒìŠ¤

- **LangChain ë¬¸ì„œ**: https://python.langchain.com/
- **LangGraph ë¬¸ì„œ**: https://langchain-ai.github.io/langgraph/
- **OpenAI API ë¬¸ì„œ**: https://platform.openai.com/docs
- **Redis ë¬¸ì„œ**: https://redis.io/documentation
- **FastAPI ë¬¸ì„œ**: https://fastapi.tiangolo.com/

---

> **ë¬¸ì„œ ë²„ì „**: v1.1 (ë„êµ¬ í™•ì¥ ê°€ì´ë“œ ë° ì¹¼ë§Œ í•„í„° ë¶„ì„ ì¶”ê°€)
> **ìµœì¢… ì—…ë°ì´íŠ¸**: 2025ë…„ 1ì›”  
> **ë‹´ë‹¹ì**: LLM Service Development Team