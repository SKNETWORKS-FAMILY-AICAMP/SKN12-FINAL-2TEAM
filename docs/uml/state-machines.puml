@startuml
skinparam backgroundColor white
skinparam state {
  BackgroundColor white
  BorderColor black
  FontColor black
}

title State Machine Diagrams

' TypingMessage state machine
state TypingMessage {
  [*] --> Idle
  Idle --> Typing : setText(text)
  Typing --> Typing : setInterval 18ms (append chars)
  Typing --> Done : idx >= len
  Done --> Idle : setText("")
  Typing --> Idle : unmount/cleanup(clearInterval)
}

' WebSocket connection retry state machine
state WebSocket {
  [*] --> Connecting
  Connecting --> Open : onOpen
  Connecting --> Backoff : onError
  Open --> Backoff : onClose
  Backoff --> Connecting : timer(exp backoff)
}

' Authentication session state machine
state AuthSession {
  [*] --> Anonymous
  Anonymous --> Authenticated : login(token)
  Authenticated --> Anonymous : logout/expire
  Authenticated --> Refreshing : t-Î” before exp
  Refreshing --> Authenticated : refresh OK
  Refreshing --> Anonymous : refresh FAIL
}

' Tutorial progress state machine
state Tutorial {
  [*] --> NotStarted
  NotStarted --> InProgress : startTutorial()
  InProgress --> StepComplete : completeStep()
  StepComplete --> InProgress : nextStep()
  InProgress --> Completed : allStepsComplete()
  Completed --> NotStarted : resetTutorial()
}
@enduml
